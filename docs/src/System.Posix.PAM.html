<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System.Posix.PAM</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadIO</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">liftIO</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Foreign.Ptr</span></span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.Posix.PAM.LowLevel.html"><span class="hs-identifier">System.Posix.PAM.LowLevel</span></a></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.Posix.PAM.Types.html"><span class="hs-identifier">System.Posix.PAM.Types</span></a></span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-comment">-- | `authSuccess` @responseCode@ checks if @responseCode@ is equal to `PamSuccess`,</span><span>
</span><span id="line-12"></span><span class="hs-comment">--   i.e. checking if authentication succeeded</span><span>
</span><span id="line-13"></span><span class="annot"><a href="System.Posix.PAM.html#authSuccess"><span class="hs-identifier hs-type">authSuccess</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Posix.PAM.Types.html#PamRetCode"><span class="hs-identifier hs-type">PamRetCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-14"></span><span id="authSuccess"><span class="annot"><span class="annottext">authSuccess :: PamRetCode -&gt; Bool
</span><a href="System.Posix.PAM.html#authSuccess"><span class="hs-identifier hs-var hs-var">authSuccess</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PamRetCode -&gt; PamRetCode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PamRetCode
</span><a href="System.Posix.PAM.Types.html#PamSuccess"><span class="hs-identifier hs-var">PamSuccess</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-comment">-- | `whenSuccess` @responseCode action@ returns @action@ if @responseCode@ is</span><span>
</span><span id="line-17"></span><span class="hs-comment">--   `PamSuccess`, otherwise returns @responseCode@</span><span>
</span><span id="line-18"></span><span id="local-6989586621679042078"><span class="annot"><a href="System.Posix.PAM.html#whenSuccess"><span class="hs-identifier hs-type">whenSuccess</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679042078"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="System.Posix.PAM.Types.html#PamRetCode"><span class="hs-identifier hs-type">PamRetCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679042078"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="System.Posix.PAM.Types.html#PamRetCode"><span class="hs-identifier hs-type">PamRetCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679042078"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="System.Posix.PAM.Types.html#PamRetCode"><span class="hs-identifier hs-type">PamRetCode</span></a></span></span><span>
</span><span id="line-19"></span><span id="whenSuccess"><span class="annot"><span class="annottext">whenSuccess :: PamRetCode -&gt; m PamRetCode -&gt; m PamRetCode
</span><a href="System.Posix.PAM.html#whenSuccess"><span class="hs-identifier hs-var hs-var">whenSuccess</span></a></span></span><span> </span><span id="local-6989586621679042059"><span class="annot"><span class="annottext">code :: PamRetCode
</span><a href="#local-6989586621679042059"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621679042058"><span class="annot"><span class="annottext">action :: m PamRetCode
</span><a href="#local-6989586621679042058"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">PamRetCode -&gt; Bool
</span><a href="System.Posix.PAM.html#authSuccess"><span class="hs-identifier hs-var">authSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">PamRetCode
</span><a href="#local-6989586621679042059"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">m PamRetCode
</span><a href="#local-6989586621679042058"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">PamRetCode -&gt; m PamRetCode
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">PamRetCode
</span><a href="#local-6989586621679042059"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-comment">-- | `authenticate` @service user password@ attempts to authenticate @user@ and</span><span>
</span><span id="line-22"></span><span class="hs-comment">--   @password@ with PAM using @service@ to determine which file in /etc/pam.d to</span><span>
</span><span id="line-23"></span><span class="hs-comment">--   use</span><span>
</span><span id="line-24"></span><span id="local-6989586621679042057"><span class="annot"><a href="System.Posix.PAM.html#authenticate"><span class="hs-identifier hs-type">authenticate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679042057"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679042057"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="System.Posix.PAM.Types.html#PamRetCode"><span class="hs-identifier hs-type">PamRetCode</span></a></span></span><span>
</span><span id="line-25"></span><span id="authenticate"><span class="annot"><span class="annottext">authenticate :: String -&gt; String -&gt; String -&gt; m PamRetCode
</span><a href="System.Posix.PAM.html#authenticate"><span class="hs-identifier hs-var hs-var">authenticate</span></a></span></span><span> </span><span id="local-6989586621679042055"><span class="annot"><span class="annottext">serviceName :: String
</span><a href="#local-6989586621679042055"><span class="hs-identifier hs-var">serviceName</span></a></span></span><span> </span><span id="local-6989586621679042054"><span class="annot"><span class="annottext">userName :: String
</span><a href="#local-6989586621679042054"><span class="hs-identifier hs-var">userName</span></a></span></span><span> </span><span id="local-6989586621679042053"><span class="annot"><span class="annottext">password :: String
</span><a href="#local-6989586621679042053"><span class="hs-identifier hs-var">password</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679042052"><span class="hs-identifier hs-type">custConv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Posix.PAM.Types.html#PamConv"><span class="hs-identifier hs-type">PamConv</span></a></span><span>
</span><span id="line-27"></span><span>        </span><span id="local-6989586621679042052"><span class="annot"><span class="annottext">custConv :: PamConv
</span><a href="#local-6989586621679042052"><span class="hs-identifier hs-var hs-var">custConv</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679042051"><span class="annot"><span class="annottext">messages :: [PamMessage]
</span><a href="#local-6989586621679042051"><span class="hs-identifier hs-var">messages</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PamResponse] -&gt; IO [PamResponse]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([PamResponse] -&gt; IO [PamResponse])
-&gt; [PamResponse] -&gt; IO [PamResponse]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PamMessage -&gt; PamResponse) -&gt; [PamMessage] -&gt; [PamResponse]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PamResponse
</span><a href="System.Posix.PAM.Types.html#PamResponse"><span class="hs-identifier hs-var">PamResponse</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679042053"><span class="hs-identifier hs-var">password</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PamMessage]
</span><a href="#local-6989586621679042051"><span class="hs-identifier hs-var">messages</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679042049"><span class="annot"><span class="annottext">pamH :: PamHandle
</span><a href="#local-6989586621679042049"><span class="hs-identifier hs-var">pamH</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679042048"><span class="annot"><span class="annottext">r1 :: PamRetCode
</span><a href="#local-6989586621679042048"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (PamHandle, PamRetCode) -&gt; m (PamHandle, PamRetCode)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (PamHandle, PamRetCode) -&gt; m (PamHandle, PamRetCode))
-&gt; IO (PamHandle, PamRetCode) -&gt; m (PamHandle, PamRetCode)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; (PamConv, Ptr ()) -&gt; IO (PamHandle, PamRetCode)
</span><a href="System.Posix.PAM.LowLevel.html#pamStart"><span class="hs-identifier hs-var">pamStart</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679042055"><span class="hs-identifier hs-var">serviceName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679042054"><span class="hs-identifier hs-var">userName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PamConv
</span><a href="#local-6989586621679042052"><span class="hs-identifier hs-var">custConv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ptr ()
forall a. Ptr a
</span><span class="hs-identifier hs-var">nullPtr</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><span class="annottext">PamRetCode -&gt; m PamRetCode -&gt; m PamRetCode
forall (m :: * -&gt; *).
MonadIO m =&gt;
PamRetCode -&gt; m PamRetCode -&gt; m PamRetCode
</span><a href="System.Posix.PAM.html#whenSuccess"><span class="hs-identifier hs-var">whenSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">PamRetCode
</span><a href="#local-6989586621679042048"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">(m PamRetCode -&gt; m PamRetCode) -&gt; m PamRetCode -&gt; m PamRetCode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-32"></span><span>        </span><span id="local-6989586621679042045"><span class="annot"><span class="annottext">PamRetCode
</span><a href="#local-6989586621679042045"><span class="hs-identifier hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO PamRetCode -&gt; m PamRetCode
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO PamRetCode -&gt; m PamRetCode) -&gt; IO PamRetCode -&gt; m PamRetCode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PamHandle -&gt; PamFlag -&gt; IO PamRetCode
</span><a href="System.Posix.PAM.LowLevel.html#pamAuthenticate"><span class="hs-identifier hs-var">pamAuthenticate</span></a></span><span> </span><span class="annot"><span class="annottext">PamHandle
</span><a href="#local-6989586621679042049"><span class="hs-identifier hs-var">pamH</span></a></span><span> </span><span class="annot"><span class="annottext">PamFlag
</span><a href="System.Posix.PAM.Types.html#PamSilent"><span class="hs-identifier hs-var">PamSilent</span></a></span><span>
</span><span id="line-33"></span><span>        </span><span class="annot"><span class="annottext">PamRetCode -&gt; m PamRetCode -&gt; m PamRetCode
forall (m :: * -&gt; *).
MonadIO m =&gt;
PamRetCode -&gt; m PamRetCode -&gt; m PamRetCode
</span><a href="System.Posix.PAM.html#whenSuccess"><span class="hs-identifier hs-var">whenSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">PamRetCode
</span><a href="#local-6989586621679042045"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">(m PamRetCode -&gt; m PamRetCode) -&gt; m PamRetCode -&gt; m PamRetCode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO PamRetCode -&gt; m PamRetCode
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO PamRetCode -&gt; m PamRetCode) -&gt; IO PamRetCode -&gt; m PamRetCode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PamHandle -&gt; PamRetCode -&gt; IO PamRetCode
</span><a href="System.Posix.PAM.LowLevel.html#pamEnd"><span class="hs-identifier hs-var">pamEnd</span></a></span><span> </span><span class="annot"><span class="annottext">PamHandle
</span><a href="#local-6989586621679042049"><span class="hs-identifier hs-var">pamH</span></a></span><span> </span><span class="annot"><span class="annottext">PamRetCode
</span><a href="System.Posix.PAM.Types.html#PamSuccess"><span class="hs-identifier hs-var">PamSuccess</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span id="local-6989586621679042041"><span class="annot"><a href="System.Posix.PAM.html#checkAccount"><span class="hs-identifier hs-type">checkAccount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679042041"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679042041"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-36"></span><span id="checkAccount"><span class="annot"><span class="annottext">checkAccount :: String -&gt; String -&gt; m (Either Int ())
</span><a href="System.Posix.PAM.html#checkAccount"><span class="hs-identifier hs-var hs-var">checkAccount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; m (Either Int ())
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">-- | `pamCodeToMessage` @responseCode@ returns a description of @responseCode@</span><span>
</span><span id="line-39"></span><span class="hs-comment">--   in the context of PAM</span><span>
</span><span id="line-40"></span><span class="annot"><a href="System.Posix.PAM.html#pamCodeToMessage"><span class="hs-identifier hs-type">pamCodeToMessage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Posix.PAM.Types.html#PamRetCode"><span class="hs-identifier hs-type">PamRetCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-41"></span><span id="pamCodeToMessage"><span class="annot"><span class="annottext">pamCodeToMessage :: PamRetCode -&gt; String
</span><a href="System.Posix.PAM.html#pamCodeToMessage"><span class="hs-identifier hs-var hs-var">pamCodeToMessage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String, String) -&gt; String
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((String, String) -&gt; String)
-&gt; (PamRetCode -&gt; (String, String)) -&gt; PamRetCode -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PamRetCode -&gt; (String, String)
</span><a href="System.Posix.PAM.html#pamCodeDetails"><span class="hs-identifier hs-var">pamCodeDetails</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">-- | `pamCodeToMessage` @responseCode@ returns the name of the define used in C</span><span>
</span><span id="line-44"></span><span class="hs-comment">--   to represent @responseCode@</span><span>
</span><span id="line-45"></span><span class="annot"><a href="System.Posix.PAM.html#pamCodeToCDefine"><span class="hs-identifier hs-type">pamCodeToCDefine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Posix.PAM.Types.html#PamRetCode"><span class="hs-identifier hs-type">PamRetCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-46"></span><span id="pamCodeToCDefine"><span class="annot"><span class="annottext">pamCodeToCDefine :: PamRetCode -&gt; String
</span><a href="System.Posix.PAM.html#pamCodeToCDefine"><span class="hs-identifier hs-var hs-var">pamCodeToCDefine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String, String) -&gt; String
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((String, String) -&gt; String)
-&gt; (PamRetCode -&gt; (String, String)) -&gt; PamRetCode -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PamRetCode -&gt; (String, String)
</span><a href="System.Posix.PAM.html#pamCodeDetails"><span class="hs-identifier hs-var">pamCodeDetails</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">-- | `pamCodeDetails` @responseCode@ returns a tuple of the name of the C define</span><span>
</span><span id="line-49"></span><span class="hs-comment">--   and a description of @responseCode@</span><span>
</span><span id="line-50"></span><span class="annot"><a href="System.Posix.PAM.html#pamCodeDetails"><span class="hs-identifier hs-type">pamCodeDetails</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Posix.PAM.Types.html#PamRetCode"><span class="hs-identifier hs-type">PamRetCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span id="pamCodeDetails"><span class="annot"><span class="annottext">pamCodeDetails :: PamRetCode -&gt; (String, String)
</span><a href="System.Posix.PAM.html#pamCodeDetails"><span class="hs-identifier hs-var hs-var">pamCodeDetails</span></a></span></span><span> </span><span class="annot"><a href="System.Posix.PAM.Types.html#PamSuccess"><span class="hs-identifier hs-type">PamSuccess</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_SUCCESS&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Successful function return&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="annot"><a href="System.Posix.PAM.html#pamCodeDetails"><span class="hs-identifier hs-var">pamCodeDetails</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Posix.PAM.Types.html#PamRetCode"><span class="hs-identifier hs-type">PamRetCode</span></a></span><span> </span><span id="local-6989586621679042033"><span class="annot"><span class="annottext">code :: Int
</span><a href="#local-6989586621679042033"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679042033"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_OPEN_ERR&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;dlopen() failure when dynamically loading a service module&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_SYMBOL_ERR&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Symbol not found&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-number">3</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_SERVICE_ERR&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Error in service module&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-number">4</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_SYSTEM_ERR&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;System error&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-number">5</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_BUF_ERR&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Memory buffer error&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-number">6</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_PERM_DENIED&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Permission denied&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-number">7</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_AUTH_ERR&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Authentication failure&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-number">8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_CRED_INSUFFICIENT&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Can not access authentication data due to insufficient credentials&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-number">9</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_AUTHINFO_UNAVAIL&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Underlying authentication service can not retrieve authentication information&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-number">10</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_USER_UNKNOWN&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;User not known to the underlying authenticaiton module&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-number">11</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_MAXTRIES&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;An authentication service has maintained a retry count which has been reached.  No further retries should be attempted&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-number">12</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_NEW_AUTHTOK_REQD&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;New authentication token required. This is normally returned if the machine security policies require that the password should be changed beccause the password is NULL or it has aged&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-number">13</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_ACCT_EXPIRED&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;User account has expired&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-number">14</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_SESSION_ERR&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Can not make/remove an entry for the specified session&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-number">15</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_CRED_UNAVAIL&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Underlying authentication service can not retrieve user credentials unavailable&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-number">16</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_CRED_EXPIRED&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;User credentials expired&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-number">17</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_CRED_ERR&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Failure setting user credentials&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-number">18</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_NO_MODULE_DATA&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;No module specific data is present&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-number">19</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_CONV_ERR&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Conversation error&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-number">20</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_AUTHTOK_ERR&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Authentication token manipulation error&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-number">21</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_AUTHTOK_RECOVERY_ERR&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Authentication information cannot be recovered&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-number">22</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_AUTHTOK_LOCK_BUSY&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Authentication token lock busy&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-number">23</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_AUTHTOK_DISABLE_AGING&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Authentication token aging disabled&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-number">24</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_TRY_AGAIN&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Preliminary check by password service&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-number">25</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_IGNORE&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Ignore underlying account module regardless of whether the control flag is required, optional, or sufficient&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-number">26</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_ABORT&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Critical error (?module fail now request)&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-number">27</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_AUTHTOK_EXPIRED&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;user's authentication token has expired&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-number">28</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_MODULE_UNKNOWN&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;module is not known&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-number">29</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_BAD_ITEM&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;Bad item passed to pam_*_item()&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-number">30</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_CONV_AGAIN&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;conversation function is event driven and data is not available yet&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-number">31</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_INCOMPLETE&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;please call this function again to complete authentication stack. Before calling again, verify that conversation is completed&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>    </span><span id="local-6989586621679042032"><span class="annot"><span class="annottext">a :: Int
</span><a href="#local-6989586621679042032"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;PAM_UNKNOWN&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;There is no code description in haskell pam library: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679042032"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span></pre></body></html>